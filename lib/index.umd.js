(function(e,t){typeof exports=="object"&&typeof module<"u"?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):(e=typeof globalThis<"u"?globalThis:e||self,t(e.JSONify={}))})(this,function(exports){"use strict";const DATE_REG=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/;function getDataType(e){return Object.prototype.toString.call(e).slice(8,-1)}function mapToArr(e){let t=[];return e.forEach((n,r)=>{t.push([r,n])}),t}function setToArr(e){let t=[];return e.forEach(n=>{t.push(n)}),t}const Strategy={Function:{stringify:e=>{let t=e.toString();return t.length<8||t.substring(0,8)!=="function"?"_AsEaAf_"+t:t}},RegExp:{stringify:e=>"_KiGyRg_"+e},Map:{stringify:e=>"_AggMap_"+stringify(mapToArr(e))},Set:{stringify:e=>"_KhsSet_"+stringify(setToArr(e))}};function stringify(e,t){return JSON.stringify(e,function(n,r){const i=getDataType(r);return Object.keys(Strategy).includes(i)?Strategy[i].stringify(r):r},t)}function parse(str){return JSON.parse(str,function(key,value){if(typeof value!="string"||value.length<8)return value;const prefix=value.substring(0,8);return DATE_REG.test(value)?new Date(value):prefix==="function"?eval("("+value+")"):prefix==="_AsEaAf_"||prefix==="_KiGyRg_"?eval(value.slice(8)):prefix==="_AggMap_"?new Map(parse(value.slice(8))):prefix==="_KhsSet_"?new Set(parse(value.slice(8))):value})}exports.parse=parse,exports.stringify=stringify,Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})});
